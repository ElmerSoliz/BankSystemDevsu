<div class="accounts-container">
  <h2>Cuentas</h2>

  <!-- Formulario de cuenta -->
  <app-account-form 
    *ngIf="selectedAccount || showForm" 
    [account]="selectedAccount" 
    (save)="formSaved()">
  </app-account-form>
  
  <button *ngIf="!showForm" (click)="toggleForm()">Nueva Cuenta</button>

  <div *ngIf="error" class="error">{{ error }}</div>

  <!-- Tabla de cuentas -->
  <table *ngIf="!showForm && accounts.length > 0">
    <thead>
      <tr>
        <th>Numero de Cuenta</th>
        <th>Tipo</th>
        <th>Balance Inicial</th>
        <th>Cliente</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let acc of accounts">
        <!-- Fila de la cuenta -->
        <tr>
          <td>{{ acc.accountNumber }}</td>
          <td>{{ accountTypeMap[acc.accountType] }}</td>
          <td>{{ acc.initialBalance }}</td>
          <td>{{ acc.client.name }}</td>
          <td>{{ acc.isActive ? 'Activo' : 'Inactivo' }}</td>
          <td>
            <button (click)="edit(acc)">Editar</button>
            <button (click)="deleteAccount(acc.id)">Eliminar</button>
            <button (click)="toggleMovements(acc)">
              {{ movementsByAccount[acc.id] ? 'Ocultar Movimientos' : 'Ver Movimientos' }}
            </button>
          </td>
        </tr>

        <tr *ngIf="movementsByAccount[acc.id]">
          <td colspan="6">
            <div class="movements-container">
              <app-movement
                [accountId]="acc.id">
              </app-movement>
            </div>
          </td>
        </tr>
      </ng-container>
    </tbody>
  </table>

  <p *ngIf="!loading && accounts.length === 0">No se encontraron cuentas.</p>
</div>
